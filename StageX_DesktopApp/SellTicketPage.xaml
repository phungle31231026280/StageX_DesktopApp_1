<Page x:Class="StageX_DesktopApp.SellTicketPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Bán vé" Background="#FF1A1A1A" Foreground="White"
      Loaded="Page_Loaded">
    <!--
        Trang bán vé dành cho nhân viên.
        Bố cục chia làm 3 khu vực:
        1. Chọn vở diễn và suất chiếu (trên cùng bên trái)
        2. Sơ đồ ghế của suất chiếu đã chọn (dưới cùng bên trái)
        3. Thông tin đơn hàng, thanh toán và nút lưu (bên phải)
    -->
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="3*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- 1. Khu vực chọn vở diễn &amp; suất chiếu -->
        <Border Grid.Column="0" Grid.Row="0" Background="#FF0C1220" CornerRadius="8" Padding="10" Margin="5">
            <StackPanel>
                <TextBlock Text="1. Vở diễn &amp; Suất chiếu" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFC107" />
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                    <TextBlock Text="Vở diễn:" VerticalAlignment="Center" Margin="0,0,5,0" />
                    <ComboBox x:Name="ShowComboBox" Width="220" DisplayMemberPath="title" SelectedValuePath="show_id" SelectionChanged="ShowComboBox_SelectionChanged" />
                    <TextBlock Text="Suất chiếu:" VerticalAlignment="Center" Margin="15,0,5,0" />
                    <ComboBox x:Name="PerformanceComboBox" Width="250" DisplayMemberPath="Display" SelectedValuePath="performance_id" SelectionChanged="PerformanceComboBox_SelectionChanged" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- 2. Khu vực sơ đồ ghế -->
        <Border Grid.Column="0" Grid.Row="1" Background="#FF0C1220" CornerRadius="8" Padding="10" Margin="5">
            <StackPanel>
                <TextBlock Text="2. Sơ đồ ghế" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFC107" />
                <ScrollViewer Margin="0,10,0,0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <Grid x:Name="SeatMapGrid" />
                </ScrollViewer>
            </StackPanel>
        </Border>

        <!-- 3. Khu vực thông tin đặt vé, thanh toán và nút lưu -->
        <Border Grid.Column="1" Grid.Row="0" Grid.RowSpan="2" Background="#FF0C1220" CornerRadius="8" Padding="10" Margin="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <!-- Tiêu đề và thông tin show/performance -->
                <StackPanel Grid.Row="0">
                    <TextBlock Text="3. Thông tin chi tiết" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFC107" />
                    <TextBlock x:Name="SelectedShowText" FontSize="14" FontWeight="SemiBold" Margin="0,5,0,0" />
                    <TextBlock x:Name="SelectedPerformanceText" FontSize="14" Margin="0,0,0,5" />
                </StackPanel>
                <!-- Danh sách ghế trong hóa đơn -->
                <DataGrid Grid.Row="1" x:Name="BillGrid" AutoGenerateColumns="False" CanUserAddRows="False" HeadersVisibility="Column" Height="160">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Ghế" Binding="{Binding SeatLabel}" Width="*" />
                        <DataGridTextColumn Header="Đơn giá" Binding="{Binding Price, StringFormat='N0'}" Width="*" />
                    </DataGrid.Columns>
                </DataGrid>
                <!-- Tổng tiền -->
                <TextBlock Grid.Row="2" x:Name="TotalTextBlock" Text="Thành tiền: 0đ" FontSize="14" FontWeight="Bold" HorizontalAlignment="Right" Margin="0,5,0,5" />
                <!-- Thanh toán và nút -->
                <StackPanel Grid.Row="3" Margin="0,10,0,0">
                    <TextBlock Text="4. Thanh toán" FontSize="16" FontWeight="SemiBold" Foreground="#FFFFC107" />
                    <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                        <RadioButton x:Name="CashRadioButton" Content="Tiền mặt" GroupName="Payment" IsChecked="True" Checked="PaymentRadioButton_Checked" Margin="0,0,15,0" Foreground="#FFFFC107" />
                        <RadioButton x:Name="BankRadioButton" Content="Chuyển khoản" GroupName="Payment" Checked="PaymentRadioButton_Checked" Foreground="#FFFFC107" />
                    </StackPanel>
                    <StackPanel x:Name="CashPanel" Orientation="Horizontal" Margin="0,5,0,0" Visibility="Visible">
                        <TextBlock Text="Khách đưa:" VerticalAlignment="Center" Margin="0,0,5,0" />
                        <TextBox x:Name="CustomerCashTextBox" Width="120" TextChanged="CustomerCashTextBox_TextChanged" />
                        <TextBlock Text="Tiền thừa:" VerticalAlignment="Center" Margin="10,0,5,0" />
                        <TextBlock x:Name="ChangeTextBlock" Text="0đ" VerticalAlignment="Center" />
                    </StackPanel>
                    <Button x:Name="SaveButton" Content="Lưu" HorizontalAlignment="Right" Padding="10,5" Margin="0,10,0,0" Click="SaveButton_Click" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Page>